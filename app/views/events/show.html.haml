.box_left_right
  .box_left
    %h2 
      Évènement crée par 
      = @event.creator.firstname
    
    %p
      %b Budget total:
      = @event.budget
    
    %p
      %b Victim:
      = @event.victim_name
    %p
      %b Description:
      = @event.description
    %p
      %b Due date:
      = @event.due_date
      
    
    %h4 Créateur
    = @event.creator.firstname
    %h4 Liste des participants
    - @event.users.each do |user|
      = user.firstname
  
  
  .box_right
    - if current_user.created_events.include?(@event) or current_user.subscribed_events.include?(@event)
      %h3 Ton budget
      = form_for @current_user_budget do |f|
        .field
          = f.text_field :amount, :value => @current_user_budget.amount
        
          = f.hidden_field :event_id, :value => @event.id
    
        .actions
          = f.submit 'Changer'
    
    - else
      = link_to "S'inscrire à l'évènement", event_subscribe_path(@event)
      
    - if current_user.created_events.include?(@event) or current_user.subscribed_events.include?(@event)
      %h3 Inviter des amis
      = form_tag event_invite_path(@event), :method => "post" do
        .field
          = label_tag :email, "Email"
          = text_field_tag :email
        .actions
          = submit_tag "Envoyer le mail"

- if current_user.created_events.include?(@event) or current_user.subscribed_events.include?(@event)
  = form_for @search do |f|
    = f.label :name_or_description_contains
    = f.text_field :name_or_description_contains

    = hidden_field_tag :event_id, @event.id

    = f.submit "Chercher"

%ul
  - @products.each do |product|
    %li
      = product.name
      \-
      = product.price 
      €
      - @idea = GiftIdeas.where(:product_id => product.id, :event_id => @event.id).first
      - @vote = Votes.where(:idea_id => @idea.id, :user_id => current_user.id).first
      - if !@vote.nil? and @vote.vote == 0
        = link_to '+', event_vote_up_path(@event, :product_id => product.id)
      - elsif !@vote.nil? and @vote.vote == 1
        = link_to '-', event_vote_down_path(@event, :product_id => product.id)
      - else
        = link_to '+', event_vote_up_path(@event, :product_id => product.id)
        = link_to '-', event_vote_down_path(@event, :product_id => product.id)
      Score 
      = Votes.where(:idea_id => @idea.id, :vote => 1).count - Votes.where(:idea_id => @idea.id, :vote => 0).count
      
